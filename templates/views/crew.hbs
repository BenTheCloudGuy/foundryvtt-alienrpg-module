<div class="wy-view-crew">
  {{!-- Crew List View — visible to all clearance levels --}}
  <div class="wy-crew-list-view" id="wy-crew-list-view">
    <div class="wy-border-box wy-crew-list">
      <div class="wy-crew-row wy-crew-row-header">
        <span class="wy-crew-col-indicator"></span>
        <span class="wy-crew-col-name">NAME</span>
        <span class="wy-crew-col-role">CAREER</span>
        <span class="wy-crew-col-location">LOCATION</span>
        <span class="wy-crew-col-status">STATUS</span>
        <span class="wy-crew-col-action"></span>
      </div>

      {{#each crew}}
      <div class="wy-crew-row" data-crew-index="{{@index}}">
        <span class="wy-crew-col-indicator"><span class="wy-indicator {{this.statusClass}}"></span></span>
        <span class="wy-crew-col-name">{{this.name}}</span>
        <span class="wy-crew-col-role">{{this.role}}</span>
        <span class="wy-crew-col-location">{{this.location}}</span>
        <span class="wy-crew-col-status {{this.statusTextClass}}">{{this.status}}</span>
        <span class="wy-crew-col-action">
          <button class="wy-log-view-btn" data-action="view-crew" data-crew-index="{{@index}}">[VIEW]</button>
        </span>
      </div>
      {{/each}}
    </div>

    {{#if activeTasks}}
    <div class="wy-section-title" style="font-size: 13px; margin-top: 24px;">ACTIVE TASKS</div>
    <div class="wy-border-box">
      <table class="wy-data-table">
        <thead>
          <tr>
            <th>CREW</th>
            <th>TASK</th>
            <th>ETA</th>
          </tr>
        </thead>
        <tbody>
          {{#each activeTasks}}
          <tr>
            <td>{{this.crewName}}</td>
            <td>{{this.task}}</td>
            <td class="wy-text-amber">{{this.eta}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
    {{/if}}
  </div>

  {{!-- Crew Detail View (hidden by default) --}}
  <div class="wy-crew-detail-view wy-hidden" id="wy-crew-detail-view">
    <div class="wy-crew-detail-container">
      <div class="wy-crew-detail-header">
        <div class="wy-crew-detail-portrait-wrap">
          <img id="wy-crew-detail-portrait" class="wy-crew-detail-portrait" src="" alt="CREW PORTRAIT" style="display:none;" />
        </div>
        <div class="wy-crew-detail-info">
          <div class="wy-crew-det-name" id="wy-crew-detail-name"></div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">CAREER:</span>
            <span id="wy-crew-detail-role"></span>
          </div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">JOB:</span>
            <span id="wy-crew-detail-job"></span>
          </div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">AGE:</span>
            <span id="wy-crew-detail-age"></span>
          </div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">LOCATION:</span>
            <span id="wy-crew-detail-location"></span>
          </div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">STATUS:</span>
            <span id="wy-crew-detail-status"></span>
          </div>
          <div class="wy-crew-det-row">
            <span class="wy-text-dim">SHIP:</span>
            <span id="wy-crew-detail-ship" class="wy-text-green"></span>
          </div>
        </div>
      </div>



      {{!-- Medical Flags --}}
      <div class="wy-crew-conditions" id="wy-crew-conditions" style="display:none;">
        <span class="wy-text-dim wy-cond-label">⚠ MEDICAL FLAGS:</span>
        <div id="wy-crew-conditions-list" class="wy-cond-tags"></div>
      </div>

      {{!-- Physical Assessment --}}
      <div class="wy-crew-stats" id="wy-crew-stats">
        <div class="wy-section-divider">PHYSICAL ASSESSMENT</div>
        <div class="wy-crew-attr-grid">
          <div class="wy-crew-attr-block">
            <div class="wy-crew-attr-val" id="wy-crew-attr-str"></div>
            <div class="wy-crew-attr-label">STRENGTH</div>
          </div>
          <div class="wy-crew-attr-block">
            <div class="wy-crew-attr-val" id="wy-crew-attr-agl"></div>
            <div class="wy-crew-attr-label">AGILITY</div>
          </div>
          <div class="wy-crew-attr-block">
            <div class="wy-crew-attr-val" id="wy-crew-attr-wit"></div>
            <div class="wy-crew-attr-label">WITS</div>
          </div>
          <div class="wy-crew-attr-block">
            <div class="wy-crew-attr-val" id="wy-crew-attr-emp"></div>
            <div class="wy-crew-attr-label">EMPATHY</div>
          </div>
        </div>
      </div>

      {{!-- Competency Ratings --}}
      <div class="wy-crew-skills" id="wy-crew-skills">
        <div class="wy-section-divider">COMPETENCY RATINGS — WY-EVAL</div>
        <div class="wy-crew-skill-groups">
          <div class="wy-crew-skill-group">
            <div class="wy-crew-skill-group-hdr">PHYSICAL</div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">HEAVY MACHINERY</span><span id="wy-crew-sk-heavyMach" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">CLOSE QUARTERS</span><span id="wy-crew-sk-closeCbt" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">ENDURANCE</span><span id="wy-crew-sk-stamina" class="wy-crew-skill-val"></span></div>
          </div>
          <div class="wy-crew-skill-group">
            <div class="wy-crew-skill-group-hdr">MOTOR SKILLS</div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">FIREARMS</span><span id="wy-crew-sk-rangedCbt" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">MOBILITY</span><span id="wy-crew-sk-mobility" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">PILOTING</span><span id="wy-crew-sk-piloting" class="wy-crew-skill-val"></span></div>
          </div>
          <div class="wy-crew-skill-group">
            <div class="wy-crew-skill-group-hdr">COGNITIVE</div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">OBSERVATION</span><span id="wy-crew-sk-observation" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">COMTECH</span><span id="wy-crew-sk-comtech" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">SURVIVAL TRAINING</span><span id="wy-crew-sk-survival" class="wy-crew-skill-val"></span></div>
          </div>
          <div class="wy-crew-skill-group">
            <div class="wy-crew-skill-group-hdr">INTERPERSONAL</div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">LEADERSHIP</span><span id="wy-crew-sk-command" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">NEGOTIATION</span><span id="wy-crew-sk-manipulation" class="wy-crew-skill-val"></span></div>
            <div class="wy-crew-skill-row"><span class="wy-text-dim">FIELD MEDICINE</span><span id="wy-crew-sk-medicalAid" class="wy-crew-skill-val"></span></div>
          </div>
        </div>
      </div>

      {{#if isGM}}
      <div class="wy-crew-gm-edit" id="wy-crew-gm-edit">
        <div class="wy-crew-gm-edit-title">GM — UPDATE CREW MEMBER</div>
        <div class="wy-crew-gm-edit-row">
          <label class="wy-crew-gm-label">STATUS</label>
          <select class="wy-setting-input" id="wy-crew-edit-status">
            <option value="ACTIVE">ACTIVE</option>
            <option value="ON DUTY">ON DUTY</option>
            <option value="OFF DUTY">OFF DUTY</option>
            <option value="RESTING">RESTING</option>
            <option value="IN CRYO">IN CRYO</option>
            <option value="INJURED">INJURED</option>
            <option value="CRITICAL">CRITICAL</option>
            <option value="MIA">MIA</option>
            <option value="KIA">KIA</option>
            <option value="QUARANTINED">QUARANTINED</option>
            <option value="DETAINED">DETAINED</option>
            <option value="UNKNOWN">UNKNOWN</option>
          </select>
        </div>
        <div class="wy-crew-gm-edit-row">
          <label class="wy-crew-gm-label">LOCATION</label>
          <select class="wy-setting-input" id="wy-crew-edit-location">
            {{!-- Options populated dynamically by JS based on active ship --}}
          </select>
        </div>
        <div class="wy-crew-gm-edit-row">
          <label class="wy-crew-gm-label">SHIP ASSIGNMENT</label>
          <select class="wy-setting-input" id="wy-crew-edit-ship">
            <option value="">UNASSIGNED</option>
            {{#each availableShips}}
            <option value="{{this.id}}">{{this.label}}</option>
            {{/each}}
          </select>
        </div>
        <div class="wy-crew-gm-edit-actions">
          <button class="wy-muthur-send" data-action="save-crew-edit">SAVE</button>
        </div>
      </div>
      {{/if}}

      <div class="wy-crew-detail-body" id="wy-crew-detail-body-wrap">
        <div class="wy-section-divider">PERSONNEL NOTES</div>
        <div class="wy-crew-detail-text" id="wy-crew-detail-body">NO ADDITIONAL PERSONNEL DATA ON FILE.</div>
      </div>
      <div class="wy-crew-detail-footer">
        <button class="wy-scene-btn" data-action="close-crew">[CLOSE]</button>
      </div>
    </div>
  </div>
</div>
